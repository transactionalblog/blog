<svg viewBox="0 0 800 460" xmlns="http://www.w3.org/2000/svg">
  <style>
  @media (prefers-color-scheme: dark) {
    text { fill: black; }
  }
  </style>

  <!-- Write-Ahead Log Container -->
  <rect x="150" y="50" width="220" height="380" fill="#f6ffed" stroke="#52c41a" stroke-width="2" rx="5" ry="5"/>
  <text x="260" y="30" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Write-Ahead Log</text>
  
  <!-- B-Tree Container -->
  <rect x="450" y="50" width="250" height="380" fill="#e6f7ff" stroke="#1890ff" stroke-width="2" rx="5" ry="5"/>
  <text x="575" y="30" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">B-Tree</text>
  
  <!-- Root V1 and Page V1 -->
  <rect x="470" y="80" width="80" height="40" fill="#91caff" stroke="#1890ff" stroke-width="1.5" rx="3" ry="3"/>
  <text x="510" y="105" font-family="Arial" font-size="14" text-anchor="middle">Root V1</text>
  
  <rect x="600" y="80" width="80" height="40" fill="#91caff" stroke="#1890ff" stroke-width="1.5" rx="3" ry="3"/>
  <text x="640" y="105" font-family="Arial" font-size="14" text-anchor="middle">Page V1</text>
  
  <!-- Arrow from Root V1 to Page V1 -->
  <line x1="550" y1="100" x2="600" y2="100" stroke="#1890ff" stroke-width="1.5" marker-end="url(#arrowhead)"/>
  
  <!-- Horizontal separator line 1 -->
  <line x1="150" y1="150" x2="700" y2="150" stroke="#999" stroke-width="1" stroke-dasharray="5,3"/>

  <!-- LSN 200 Delta with Initial Write heading -->
  <text x="180" y="170" font-family="Arial" font-size="14" text-anchor="start" font-weight="bold">Initial Write</text>
  <rect x="165" y="180" width="190" height="60" fill="#b7eb8f" stroke="#52c41a" stroke-width="1" rx="3" ry="3"/>
  <text x="260" y="205" font-family="Arial" font-size="14" text-anchor="middle">LSN 200</text>
  <text x="260" y="225" font-family="Arial" font-size="12" text-anchor="middle">Delta for Page V2</text>
  
  <!-- Root V2 and Page V2 -->
  <rect x="470" y="180" width="80" height="40" fill="#b7eb8f" stroke="#52c41a" stroke-width="1.5" rx="3" ry="3"/>
  <text x="510" y="205" font-family="Arial" font-size="14" text-anchor="middle">Root V2</text>
  
  <rect x="600" y="180" width="80" height="40" fill="#b7eb8f" stroke="#52c41a" stroke-width="1.5" rx="3" ry="3"/>
  <text x="640" y="205" font-family="Arial" font-size="14" text-anchor="middle">Page V2</text>
  
  <!-- Arrow from Root V2 to Page V2 -->
  <line x1="550" y1="200" x2="600" y2="200" stroke="#52c41a" stroke-width="1.5" marker-end="url(#arrowhead)"/>
  
  <!-- Horizontal separator line 2 -->
  <line x1="150" y1="250" x2="700" y2="250" stroke="#999" stroke-width="1" stroke-dasharray="5,3"/>
  
  <!-- Grayed out Page V2 -->
  <rect x="600" y="280" width="80" height="40" fill="#b7eb8f" stroke="#52c41a" stroke-width="1.5" rx="3" ry="3" opacity="0.3"/>
  <text x="640" y="305" font-family="Arial" font-size="14" text-anchor="middle" opacity="0.3">Page V2</text>
  
  <!-- LSN 300 Delta with Subsequent Writes heading -->
  <text x="180" y="290" font-family="Arial" font-size="14" text-anchor="start" font-weight="bold">Subsequent Writes</text>
  <rect x="165" y="300" width="190" height="60" fill="#ffe58f" stroke="#fa8c16" stroke-width="1" rx="3" ry="3"/>
  <text x="260" y="325" font-family="Arial" font-size="14" text-anchor="middle">LSN 300</text>
  <text x="260" y="345" font-family="Arial" font-size="12" text-anchor="middle">Delta for Page V3</text>
  
  <!-- Root V2 (same) and Page V3 -->
  <rect x="470" y="360" width="80" height="40" fill="#b7eb8f" stroke="#52c41a" stroke-width="1.5" rx="3" ry="3"/>
  <text x="510" y="385" font-family="Arial" font-size="14" text-anchor="middle">Root V2</text>
  
  <rect x="600" y="360" width="80" height="40" fill="#ffe58f" stroke="#fa8c16" stroke-width="1.5" rx="3" ry="3"/>
  <text x="640" y="385" font-family="Arial" font-size="14" text-anchor="middle">Page V3</text>
  
  <!-- Arrow from Root V2 to Page V3 -->
  <line x1="550" y1="380" x2="600" y2="380" stroke="#52c41a" stroke-width="1.5" marker-end="url(#arrowhead)"/>
  
  <!-- Arrows indicating COFW process - now straight -->
  <line x1="355" y1="210" x2="470" y2="200" stroke="#666" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
  <line x1="355" y1="330" x2="600" y2="360" stroke="#666" stroke-width="1.5" stroke-dasharray="5,3" marker-end="url(#arrowhead)"/>
  
  <!-- Arrow definitions -->
  <defs>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" />
    </marker>
  </defs>
</svg>
